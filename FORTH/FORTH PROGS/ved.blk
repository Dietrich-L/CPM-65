( FULL SCREEN EDITOR      D. Lausberg 31.8.97      SCR #1 )     VOCABULARY VED immediate VED DEFINITIONS                        decimal                                                         1 VARIABLE &MODE    1 VARIABLE &CUR                             1 variable &tag1    1 variable &tag2                            0 variable &BUF                                                 9 constant ht       8 constant bs                               28 constant home                                                1023 constant cps  15 constant lps                              : nbs 0 do bs emit loop ;                                                                                                       : CLS 12 EMIT ;                                                 : nvt dup 0= if drop else 0 do 11 emit loop endif ;             : xcr 13 emit lps < if 10 emit endif ;                          : .L (LINE) -trailing 1 max type ;                              -->                                                             ( FULL SCREEN EDITOR                                SCR #2 )    : curpos &cur @ ;                                               : !cur &cur ! ;                                                 : >line# c/l / ;                                                : line#> c/l * ;                                                : line@ scr @ (line) ;                                          : bufpos curpos >line# line@ drop curpos c/l mod +                  dup &BUF ! ;                                                : +1BUF &BUF @ 1+ &BUF ! ;                                      : +1cur curpos 1+ dup cps > if drop cps bs emit endif !cur ;    : -1cur curpos 1 - dup 0 < if drop 0 ht emit endif !cur ;       : #toeol c/l mod c/l swap - ;                                                                                                   -->                                                                                                                                                                                             ( Full Screen Editor                                  SCR #3 )  : ?prt dup bl < swap 126 > or 0= ;                              : nop ;                                                         : exec swap 2 * + @ execute ;                                                                                                                                                                   : larrow -1cur bs emit ;                                        : rarrow +1cur ht emit ;                                        : uarrow curpos c/l - dup 0 < if drop curpos else                 11 emit endif !cur ;                                          : darrow curpos c/l + dup cps > if drop curpos else               10 emit endif !cur ;                                                                                                          : imode &mode  @ -1 xor &mode ! ; ( toggle insert mode )                                                                        -->                                                             ( Full Screen Editor                               SCR #4 )     : distoeos 13 emit dup line#> !cur lps 1+ over do i scr @         .L i xcr loop 15 swap - nvt ;                                 : updscr cls 0 distoeos ;                                       : scr-ini updscr ;                                              : nxtblk 1 scr +! scr-ini ;                                     : lstblk scr @ 1 - dup 3 < if drop 3 endif                        scr ! scr-ini ;                                               : quit-ed cls ." edit complete" flush forth quit ;                                                                              : clrline line@ blanks update ;                                 : ?empty line@ -trailing swap drop 0= ;                         : -move line@ cmove update ;                                    : exp dup 1 - 14 do i line@ drop i 1+ -move -1 +loop              clrline ;                                                     -->                                                             ( Full Screen Editor                                 SCR #5 )   : shrink lps dup rot do i 1+ line@ drop i -move loop              clrline ;                                                     : clear-page 16 0 do I clrline loop updscr ;                    : copy b/scr * offset @ + swap b/scr * b/scr over + swap          do dup I block 2 - ! 1+ update loop drop flush ;                                                                              : insertline lps ?empty if dup exp distoeos                       endif ;                                                       : deleteline dup shrink distoeos ;                              : clp clear-page ;                                              : iline curpos >line# insertline ;                              : dline curpos >line# deleteline ;                                                                                              : tab 8 curpos 8 mod - 0 do +1cur ht emit loop ;                -->                                                             ( Full Screen Editor                              SCR #6 )      : #in pad 10 expect 0 0 pad 1 - (number) drop drop ;            : edits cls ."   Edit SCR #: " #in scr ! scr-ini ;                                                                              : settag scr @ key dup 49 = if swap &tag1 ! endif                                      50 = if &tag2 ! else drop endif ;        : totag key dup 49 = if &tag1 @ scr ! scr-ini endif                             50 = if &tag2 @ scr ! scr-ini endif ;                                                                           : REP pad 1+ swap -move ;                                       : holdln curpos >line# line@ pad c! pad 1+ c/l cmove ;          : putln curpos >line# dup &mode @ if                                    lps ?empty if dup exp REP else drop endif                   else REP endif distoeos ;                                                                                                   -->                                                             ( Full Screen Editor                                 SCR #7 )   : ret &mode @ if iline else curpos >line# 1+ dup 15 <             if 10 emit endif 15 min line#> !cur 29 emit endif ;                                                                           : delchar bufpos dup >R dup 1+ swap curpos #toeol 1 - dup         >R cmove R> R> + bl swap c! update ;                          : distoeol bufpos swap #toeol -trailing 1+ swap                   over type nbs ;                                               : dchar delchar curpos distoeol ;                               : inschar dup >R here over over curpos #toeol 1 -                 dup >R cmove swap 1+ R> cmove R> c! update ;                  : ins-page scr @ eom @ lo - 1024 / 4 +                            do i 1 - i copy -1 +loop clear-page ;                         : RUBOUT larrow dchar ;                                         : .mode 18 spaces &mode @ if ." INSERT " else 7 spaces endif ;  -->                                                             ( Full Screen Editor                                 SCR #8 )   : help cls 15 spaces ." Commands" .mode ."   SCR# " scr @ . cr    ."  CTL-E  Cursor up           ESC    Help" cr                  ."  CTL-X  Cursor down         CTL-V  Insert on/off" cr         ."  CTL-D  Cursor right        CTL-G  Delete chr" cr            ."  CTL-S  Cursor left         CTL-Y  Delete line" cr           ."  CTL-R  Page up             CTL-N  Insert new page" cr       ."  CTL-A  Page down           CTL-B  Edit SCR #" cr            ."  CTL-F  Tab                 CTL-Z  Clear page" cr            ."  CTL-Ux Set tagx to SCR     CTL-O  Copy line to PAD" cr      ."  CTL-Tx Goto tagged SCR     CTL-P  Put PAD to line" cr       cr                                                              ."                             CTL-Q  Quit editor" cr           cr                                                              ." Press key to continue " key drop updscr ;                  -->                                                             ( Full Screen Editor                                 SCR #9 )   0 variable cmd -2 allot                                           ] nop    nxtblk  edits  nop    rarrow uarrow tab      dchar       larrow rarrow  darrow uarrow nop    ret    ins-page holdln      putln  quit-ed lstblk larrow totag  settag imode    nop         darrow dline   clp    help   updscr nop    nop      nop [                                                                   : command dup 127 = if RUBOUT else cmd exec endif ;             : insertoff key dup ?prt if dup emit curpos 255 and                 if &BUF @ else bufpos endif C! +1BUF +1CUR update              else command bufpos drop endif ;                             : inserton key dup ?prt if dup emit &buf @ inschar +1cur          curpos distoeol update else command bufpos drop then ;        : vedit decimal 0 &mode ! 3 scr ! scr-ini bufpos &buf !           begin &mode @ if inserton else insertoff then again ;         -->                                                             ( Full Screen Editor                                 SCR #10 )  FORTH Definitions                                               : e ved vedit ;                                                 : new LO EOM ! 3 scr ! ved 16 0 do I clrline loop vedit ;                                                                                                                                       latest    12 +origin !  ( top NFA )                             ( here      28 +origin !  ( Fence )                             here      30 +origin !  ( DP )                                  ' VED      6 +origin !  ( Voc-Link )                            ( here      Fence ! )    ;S                                                                                                                                                                                                                                                                                                                                                                     IûN-±çlYKõç<	O6üÌiñZÖIJkI¡πxÃDmŒmyXwÚ!mC£ÕM«j¸Ç˜˝IÓç™ºóΩ≥dô(nÀUëá-=@DèÎ: ÑP⁄üê#MàMÎj≥NP€)-çã¬°Ì÷l…Eå… µ≠$XÍè=ù?ã@ë*V˘	Aá.Mõ/jmç¶ß™®]
*Mü	Èu¬ßÏCË≥YE~grZdöCvÖO?πÕX/MHc0Ì€ÄÂ´Ø…∏Ä@∞œûÏä{f/T$-ÔNI¡KImÊèã’œ%-_MC5˛|¯>ü¯ÕàMﬂ-ﬂ‹Æ}ËÓØMWG∆Ô(9¬|ïôIÔá\I•&…ÒÓ˙§-ìÔQ«û	SoOÃ!›ôùmiø¶´ÌáäRÃ>˙û+z.Œ/MEÁ…@eL`‚ru$G	≠iWH	3Xn˙î∫±-≠T	M˛[é-âiäHEÕ÷	òÑncÌ>Ñ4Û{ƒßWœ&EÎü}ôòTK}ó≠i∂ÂAÀ œàD–eoßGƒg?H.b	Ic	Ÿ0UàóÅYﬁiY¬p‡÷ÿ¶Ó£«G◊E)maP¨JçQA´vãñûç:¥ÆyÅQ‘A
D¸/?ÎÕŒ_ﬂE°jH_ 